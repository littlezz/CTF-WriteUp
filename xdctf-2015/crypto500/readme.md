crypto500
=======================



WriteUp
--------------

记X(P)为取P点的x坐标值。

加密过程如下  

```
i0 = random_seed
i1 = X(i0*P)
out0 = X(i1*Q)

i2 = X(i1*P)
out1 = X(i2*Q)
```


存在e， 使得 ed % r == 1

```
设 X(i1*Q) = X(A)，  

因为Q == d*P,

i1*Q*e == e*d*i1*P 

所以Ae == i1*P
```

-------------------------------------------------------


第一次生成生成的随机数是x轴方向的值， 利用公式  

    y^2 = x^3 + ax + b (mod m) 

a,b,r，m 在seccure中使用的椭圆里是固定的， 解出y的值， 从而得到A点。  

好吧， 到了本题最难的部分。。。  
解 `x^2 = a (mod p)`  是要用到奇怪的定理的，**直接开平方会跪(哭**， 搜索`modular square root`， 搞到计算的代码。


之后可以方便的得到i2 从而预测下一个输出的值了










